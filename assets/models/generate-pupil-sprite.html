<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RECESS REVENGE - Chibi Pupil Spritesheet Generator</title>
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            margin: 0;
        }
        h1 {
            text-shadow: 0 0 20px #00ffff, 0 0 30px #00ffff;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        .subtitle {
            opacity: 0.9;
            margin-bottom: 30px;
        }
        canvas {
            border: 4px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            image-rendering: pixelated;
            image-rendering: crisp-edges;
        }
        .controls {
            margin-top: 30px;
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }
        button {
            background: linear-gradient(145deg, #2a2a2a, #1a1a1a);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 15px 30px;
            font-size: 18px;
            font-weight: bold;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow:
                5px 5px 10px rgba(0, 0, 0, 0.3),
                -2px -2px 10px rgba(255, 255, 255, 0.1);
            text-shadow: 0 0 10px #00ffff;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow:
                0 0 20px #00ffff,
                5px 5px 15px rgba(0, 0, 0, 0.4);
        }
        button:active {
            transform: translateY(0);
        }
        .info {
            margin-top: 20px;
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 12px;
            max-width: 600px;
            backdrop-filter: blur(10px);
        }
        .info h3 {
            margin-top: 0;
            color: #00ffff;
            text-shadow: 0 0 10px #00ffff;
        }
        #previewCanvas {
            margin-top: 20px;
            border: 2px solid #00ffff;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
        }
        .label {
            margin-top: 10px;
            font-size: 14px;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <h1>Chibi Pupil Spritesheet Generator</h1>
    <p class="subtitle">Mischievous Schoolkid - Chibi Style for RECESS REVENGE</p>

    <canvas id="spritesheetCanvas" width="384" height="192"></canvas>
    <p class="label">Full Spritesheet (384x192)</p>

    <canvas id="previewCanvas" width="256" height="256"></canvas>
    <p class="label">Animation Preview (click to cycle animations)</p>

    <div class="controls">
        <button onclick="downloadSpritesheet()">Download Spritesheet PNG</button>
        <button onclick="regenerate()">Regenerate</button>
    </div>

    <div class="info">
        <h3>Spritesheet Layout</h3>
        <p>
            <strong>Row 0:</strong> Idle (4 frames @ 64x64)<br>
            <strong>Row 1:</strong> Throw (6 frames @ 64x64)<br>
            <strong>Row 2:</strong> Celebrate (4 frames @ 64x64)
        </p>
        <p>
            Total size: 384x192 pixels<br>
            Save as: <code>pupil-spritesheet.png</code>
        </p>
    </div>

    <script>
        const canvas = document.getElementById('spritesheetCanvas');
        const ctx = canvas.getContext('2d');
        const previewCanvas = document.getElementById('previewCanvas');
        const previewCtx = previewCanvas.getContext('2d');

        // Color palette for mischievous pupil
        const COLORS = {
            SKIN: '#FFCC99',
            HOODIE: '#C0392B',       // Red hoodie
            HOODIE_POCKET: '#A93226', // Darker red pocket
            SHORTS: '#2C3E50',       // Dark navy shorts
            HAIR: '#3D2314',         // Dark brown messy hair
            EYES: '#000000',
            MOUTH: '#000000',
            SHOES: '#FFFFFF',        // White sneakers
            SHOE_ACCENT: '#C0392B',  // Red accent on shoes
            EGG: '#FFF8DC',          // Cream/white egg
            EGG_SHADOW: '#F5DEB3'    // Wheat color shadow
        };

        // Animation preview state
        let previewAnimIndex = 0;
        let previewFrame = 0;
        let previewTime = 0;
        const animations = ['idle', 'throw', 'celebrate'];
        const animFrameCounts = { idle: 4, throw: 6, celebrate: 4 };
        const animSpeeds = { idle: 200, throw: 100, celebrate: 150 }; // ms per frame

        // Draw chibi pupil at given position with animation frame
        function drawPupil(x, y, frame, animType = 'idle') {
            ctx.save();
            ctx.translate(x + 32, y + 32); // Center of 64x64 frame

            // Chibi proportions: 2.5 heads tall (matching teacher)
            const headSize = 20;
            const bodyHeight = 14;
            const legLength = 8;

            // Animation offsets
            let bobOffset = 0;
            let legSwing = 0;
            let armSwing = 0;
            let armAngle = 0;
            let jumpOffset = 0;
            let headTilt = 0;
            let showEgg = true;

            if (animType === 'idle') {
                // Gentle bobbing while tossing egg - 4 frames spread across full cycle
                const idlePhase = (frame / 4) * Math.PI * 2;
                bobOffset = Math.sin(idlePhase) * 1.5;
                // Arm moves up and down tossing egg
                armSwing = Math.sin(idlePhase) * 3;
            } else if (animType === 'throw') {
                // Throw animation - 6 frames spread across full cycle
                const throwPhase = (frame / 6) * Math.PI * 2;

                // Wind-up and throw motion
                if (frame < 2) {
                    // Wind-up - pull arm back
                    armAngle = -30;
                    bobOffset = -1;
                } else if (frame < 4) {
                    // Throw - arm forward
                    armAngle = 60;
                    bobOffset = -2;
                    headTilt = 2;
                } else {
                    // Follow-through - arm continues forward, egg is gone
                    armAngle = 40;
                    bobOffset = 0;
                    showEgg = false;
                }
                legSwing = Math.sin(throwPhase) * 3;
            } else if (animType === 'celebrate') {
                // Jump and cheer - 4 frames spread across full cycle
                const celebratePhase = (frame / 4) * Math.PI * 2;
                jumpOffset = Math.abs(Math.sin(celebratePhase)) * 8;
                bobOffset = -jumpOffset;
                // Both arms up in celebration
                armSwing = 0;
                armAngle = -45; // Arms raised
                showEgg = false;
            }

            // --- LEGS (drawn first, behind body) ---
            ctx.fillStyle = COLORS.SHORTS;

            // Left leg
            ctx.fillRect(-6 + legSwing, 8 + bobOffset, 5, legLength);
            // Right leg
            ctx.fillRect(1 - legSwing, 8 + bobOffset, 5, legLength);

            // Shoes
            ctx.fillStyle = COLORS.SHOES;
            ctx.fillRect(-7 + legSwing, 15 + bobOffset, 6, 3);
            ctx.fillRect(0 - legSwing, 15 + bobOffset, 6, 3);

            // Shoe accents (red stripes)
            ctx.fillStyle = COLORS.SHOE_ACCENT;
            ctx.fillRect(-6 + legSwing, 15 + bobOffset, 4, 1);
            ctx.fillRect(1 - legSwing, 15 + bobOffset, 4, 1);

            // --- BODY ---
            // Hoodie body
            ctx.fillStyle = COLORS.HOODIE;
            ctx.fillRect(-8, -6 + bobOffset, 16, bodyHeight);

            // Hoodie pocket
            ctx.fillStyle = COLORS.HOODIE_POCKET;
            ctx.fillRect(-4, 2 + bobOffset, 8, 4);

            // Hood outline on head (drawn later with head)

            // --- LEFT ARM (behind egg if holding) ---
            ctx.fillStyle = COLORS.HOODIE;

            if (animType === 'celebrate') {
                // Both arms raised
                ctx.fillRect(-11, -8 + bobOffset, 3, 8);
            } else {
                // Normal left arm (swinging)
                ctx.fillRect(-11, -4 + bobOffset + armSwing, 3, 10);
            }

            // --- EGG (if visible) ---
            if (showEgg) {
                const eggX = 8;
                const eggY = -2 + bobOffset - armSwing + (armAngle / 10);

                // Egg shadow
                ctx.fillStyle = COLORS.EGG_SHADOW;
                ctx.fillRect(eggX + 1, eggY + 1, 5, 7);

                // Egg body
                ctx.fillStyle = COLORS.EGG;
                ctx.fillRect(eggX, eggY, 5, 7);

                // Egg shine
                ctx.fillStyle = '#FFFFFF';
                ctx.fillRect(eggX + 1, eggY + 1, 2, 2);
            }

            // --- RIGHT ARM (holding/throwing egg) ---
            ctx.fillStyle = COLORS.HOODIE;

            if (animType === 'celebrate') {
                // Right arm raised
                ctx.fillRect(8, -8 + bobOffset, 3, 8);
            } else if (animType === 'throw') {
                // Throwing arm motion
                const armX = 8;
                const armY = -4 + bobOffset;

                ctx.save();
                ctx.translate(armX, armY);
                ctx.rotate((armAngle * Math.PI) / 180);
                ctx.fillRect(0, 0, 3, 10);
                ctx.restore();
            } else {
                // Normal right arm holding egg
                ctx.fillRect(8, -4 + bobOffset - armSwing, 3, 10);
            }

            // --- HEAD (big chibi head!) ---
            ctx.fillStyle = COLORS.SKIN;
            ctx.fillRect(-10, -26 + bobOffset + headTilt, headSize, headSize);

            // Messy spiky hair
            ctx.fillStyle = COLORS.HAIR;
            // Base hair
            ctx.fillRect(-10, -26 + bobOffset + headTilt, headSize, 6);
            // Spiky tufts
            ctx.fillRect(-10, -27 + bobOffset + headTilt, 4, 3);
            ctx.fillRect(-4, -28 + bobOffset + headTilt, 4, 4);
            ctx.fillRect(2, -27 + bobOffset + headTilt, 4, 3);
            ctx.fillRect(8, -26 + bobOffset + headTilt, 2, 2);
            // Side hair
            ctx.fillRect(-10, -24 + bobOffset + headTilt, 3, 8);
            ctx.fillRect(7, -24 + bobOffset + headTilt, 3, 8);

            // Eyes (mischievous look)
            ctx.fillStyle = COLORS.EYES;
            ctx.fillRect(-6, -18 + bobOffset + headTilt, 3, 3);
            ctx.fillRect(3, -18 + bobOffset + headTilt, 3, 3);

            // Pupils
            ctx.fillRect(-5, -17 + bobOffset + headTilt, 1, 1);
            ctx.fillRect(4, -17 + bobOffset + headTilt, 1, 1);

            // Mischievous grin
            ctx.fillStyle = COLORS.MOUTH;
            ctx.fillRect(-5, -12 + bobOffset + headTilt, 8, 2);
            // Curved up at edges for grin
            ctx.fillRect(-6, -13 + bobOffset + headTilt, 1, 1);
            ctx.fillRect(3, -13 + bobOffset + headTilt, 1, 1);

            ctx.restore();
        }

        // Generate the full spritesheet
        function generateSpritesheet() {
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Row 0: Idle (4 frames)
            for (let i = 0; i < 4; i++) {
                drawPupil(i * 64, 0, i, 'idle');
            }

            // Row 1: Throw (6 frames)
            for (let i = 0; i < 6; i++) {
                drawPupil(i * 64, 64, i, 'throw');
            }

            // Row 2: Celebrate (4 frames)
            for (let i = 0; i < 4; i++) {
                drawPupil(i * 64, 128, i, 'celebrate');
            }
        }

        // Download spritesheet as PNG
        function downloadSpritesheet() {
            const link = document.createElement('a');
            link.download = 'pupil-spritesheet.png';
            link.href = canvas.toDataURL('image/png');
            link.click();
        }

        // Regenerate spritesheet
        function regenerate() {
            generateSpritesheet();
            startPreview();
        }

        // Preview animation
        function animatePreview() {
            const currentAnim = animations[previewAnimIndex];
            const frameCount = animFrameCounts[currentAnim];
            const animSpeed = animSpeeds[currentAnim];

            const now = Date.now();
            if (now - previewTime > animSpeed) {
                previewTime = now;
                previewFrame = (previewFrame + 1) % frameCount;

                // Clear preview canvas
                previewCtx.clearRect(0, 0, previewCanvas.width, previewCanvas.height);

                // Draw background
                previewCtx.fillStyle = 'rgba(58, 58, 58, 0.3)';
                previewCtx.fillRect(0, 0, previewCanvas.width, previewCanvas.height);

                // Draw label
                previewCtx.fillStyle = '#00ffff';
                previewCtx.font = 'bold 20px Arial';
                previewCtx.textAlign = 'center';
                previewCtx.fillText(currentAnim.toUpperCase(), previewCanvas.width / 2, 30);

                // Draw current frame scaled up 3x
                previewCtx.save();
                previewCtx.imageSmoothingEnabled = false;

                const sourceX = previewFrame * 64;
                const sourceY = previewAnimIndex * 64;
                const scale = 3;
                const destX = (previewCanvas.width - 64 * scale) / 2;
                const destY = (previewCanvas.height - 64 * scale) / 2;

                previewCtx.drawImage(
                    canvas,
                    sourceX, sourceY, 64, 64,
                    destX, destY, 64 * scale, 64 * scale
                );

                previewCtx.restore();
            }

            requestAnimationFrame(animatePreview);
        }

        // Cycle through animations on click
        previewCanvas.addEventListener('click', () => {
            previewAnimIndex = (previewAnimIndex + 1) % animations.length;
            previewFrame = 0;
        });

        // Start preview animation
        function startPreview() {
            previewTime = Date.now();
            animatePreview();
        }

        // Initialize
        generateSpritesheet();
        startPreview();
    </script>
</body>
</html>
